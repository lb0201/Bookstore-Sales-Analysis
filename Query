//Project Overview:
//In this data analysis project, we aim to analyze a dataset containing information about book sales and customer preferences. 
//The dataset includes tables for Customers, Orders, Publisher, Author, Books, OrderItems, and more. 
//Our goal is to gain insights into book sales patterns, and customer preferences, and identify the best-selling book.


//Analyze book sales trends, including the total number of orders and sales revenue over time.

SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS "Month",
       COUNT(Order#) AS "Total Orders",
       SUM(b.Retail * oi.Quantity) AS "Sales Revenue"
FROM Orders o
JOIN OrderItems oi ON o.Order# = oi.Order#
JOIN Books b ON oi.ISBN = b.ISBN
GROUP BY TO_CHAR(OrderDate, 'YYYY-MM')
ORDER BY TO_CHAR(OrderDate, 'YYYY-MM');

//Identify the best-selling book and its corresponding sales revenue.
SELECT b.Title AS "Best-Selling Book",
       COUNT(oi.ISBN) AS "Number of Orders",
       SUM(oi.Quantity * oi.PaidEach) AS "Total Sales Revenue"
FROM Books b
JOIN OrderItems oi ON b.ISBN = oi.ISBN
GROUP BY b.Title
ORDER BY SUM(oi.Quantity) DESC
FETCH FIRST 1 ROWS ONLY;

//Explore customer preferences based on their regions, popular book categories, and promotional items' effectiveness.

SELECT c.Region,
       b.Category,
       COUNT(oi.Order#) AS "Number of Orders"
FROM Customers c
JOIN Orders o ON c.Customer# = o.Customer#
JOIN OrderItems oi ON o.Order# = oi.Order#
JOIN Books b ON oi.ISBN = b.ISBN
GROUP BY c.Region, b.Category
ORDER BY c.Region, b.Category;
